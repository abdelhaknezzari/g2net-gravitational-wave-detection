---
title: "README"
output: md_document
---

https://www.kaggle.com/c/g2net-gravitational-wave-detection/overview

Nice book about sound analysis using R [](https://link.springer.com/book/10.1007/978-3-319-77647-7), it shows many examples for plotting spectorgrams

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

source('shinyApplication/functions.R')
```

## R Markdown

Read file npy

```{r Time analysis}
library(RcppCNPy)
library(tidyverse)
library(tuneR)
library(seewave)

"00000e74ad.npy" %>% npyLoad() -> imat

imat %>%
  t() %>%
  as.data.frame() %>%
  rename( x =V1 , y = V2 , z = V3) %>%
  add_column( index = 1:(imat %>% ncol()) ) %>%
  gather( key, value , -index ) %>%
  ggplot( aes (y = value, x = index) ) +
  geom_line() +
  facet_grid(rows = vars(key)) +
  xlab("Time") + ylab("Intensity")


```



```{r  Frequency Anlysis}
"00001f4945.npy" %>% readWaveFromNpy(1)  %>% spec( flim = c(0,0.03) )


```





## Including Plots

You can also embed plots, for example:

```{r  Time frequency}

"00001f4945.npy" %>% npyLoad() %>% scale()-> imat
imat <- imat * 20
imat %>%  .[2,] %>% Wave( left = .,samp.rate = 2048 )  %>%
  spectro( flim = c(0,0.2) , palette = colorRampPalette(c("white", "blue", "green")) , ovlp = 50)

```

similar to [example](https://rug.mnhn.fr/seewave/spec.html)
the code was copied form the above source, we have refactored it into different functions, to avoid occyping the memory with temporarly useless data
the result we are looking is to plot some graphs.

```{r Time frequency}

"00001f4945.npy" %>% readWaveFromNpy(2) %>% showPlots()

```





